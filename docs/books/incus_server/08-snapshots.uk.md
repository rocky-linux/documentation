---
title: 8 Контейнер Snapshots
author: Steven Spencer
contributors: Ezequiel Bruni, Ganna Zhyrnova
tested_with: 9.4
tags:
  - incus
  - enterprise
  - incus snapshots
---

У цій главі ви повинні запускати команди як непривілейований користувач ("incusadmin", якщо ви стежите за ними з початку цієї книги).

Знімки контейнера та сервер знімків (докладніше про це пізніше) є, мабуть, найважливішим аспектом роботи робочого сервера Incus. Снепшоти забезпечують швидке відновлення. Доцільно використовувати їх як захист від збоїв під час оновлення основного програмного забезпечення, яке працює на певному контейнері. Якщо під час оновлення щось трапиться, що призведе до поломки цієї програми, ви просто відновите знімок, і ви відновите роботу з лише кількома секундами простою.

Автор використовував контейнери Incus для публічних серверів PowerDNS, і оновлення цих програм стало менш проблематичним завдяки створенню знімків перед кожним оновленням.

Ви навіть можете зробити снепшот контейнера під час його роботи.

## Процес снепшот

Ми почнемо з отримання снепшот контейнера ubuntu-test за допомогою цієї команди:

```bash
incus snapshot ubuntu-test ubuntu-test-1
```

Тут ми називаємо снепшот «ubuntu-test-1», але його можна називати як завгодно. Щоб переконатися, що у вас є знімок, виконайте `incus info` контейнера:

```bash
incus info ubuntu-test
```

Ви вже дивилися на інформаційний екран. Якщо прокрутити вниз, ви побачите:

```bash
Snapshots:
  ubuntu-test-1 (taken at 2021/04/29 15:57 UTC) (stateless)
```

Success! Наш снепшот на місці.

Тепер перейдіть до контейнера ubuntu-test:

```bash
incus shell ubuntu-test
```

Створіть порожній файл за допомогою команди _touch_:

```bash
touch this_file.txt
```

Тепер вийдіть з контейнера.

Перш ніж ми відновимо контейнер, як він був до створення файлу, найбезпечніший спосіб відновити контейнер, особливо якщо було багато змін, це спочатку зупинити його:

```bash
incus stop ubuntu-test
```

Потім відновіть його:

```bash
incus restore ubuntu-test ubuntu-test-1
```

Потім знову запустіть контейнер:

```bash
incus start ubuntu-test
```

Якщо ви знову повернетесь у контейнер і подивитесь, наш «this_file.txt», який ми створили, тепер зник.

Якщо снепшот більше не потрібен, його можна видалити:

```bash
incus delete ubuntu-test/ubuntu-test-1
```

!!! warning "Важливо"

````
Ви повинні остаточно видалити знімки, коли контейнер працює. Чому? Ну, команда _incus delete_ також працює для видалення всього контейнера. Якщо ми випадково натиснемо Enter після "ubuntu-test" у команді вище, І якщо контейнер буде зупинено, контейнер буде видалено. Попередження не дається. Він просто виконує те, що ви просите.

If the container is running, however, you will get this message:

```
Error: The instance is currently running, stop it first or pass --force
```

Отже, назавжди видаліть знімки, поки контейнер працює.
````

У наступних розділах ви:

- налаштуєте процес автоматичного створення snapshots
- налаштуєте термін дії снепшота, щоб він зникав через певний проміжок часу
- налаштуєте автоматичне оновлення снепшотів на снепшот сервері
